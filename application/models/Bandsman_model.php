<?phpclass Bandsman_model extends CI_Model {    public function __construct() {        $this->load->database();    }    public function BandsmanIdsGetBandsman($bandsman_id) {        if (count($bandsman_id) > 0) {            $q = "select bandsman.*,instrument.name as instrument_name from bandsman left join instrument on bandsman.instrument_id=instrument.id where bandsman.id=" . $bandsman_id[0];            for ($i = 1; $i < count($bandsman_id); $i++) {                $q .= " or bandsman.id=" . $bandsman_id[$i];            }            $query = $this->db->query($q);            return $query->result_array();        }    }    public function BandsmanIdGetBandsman($bandsman_id) {        $q = "select bandsman.*,instrument.name as instrument_name from bandsman left join instrument on bandsman.instrument_id=instrument.id where bandsman.id=" . $bandsman_id;        $query = $this->db->query($q);        return $query->row_array();    }    public function BandIdsGetBand($band_id) {        if (count($band_id) > 0) {            $q = "select * from band where id=" . $band_id[0];            for ($i = 1; $i < count($band_id); $i++) {                $q .= " or id=" . $band_id[$i];            }            $query = $this->db->query($q);            return $query->result_array();        }    }    public function AgreeBandMember($band_id, $bandsman_id) {//        $q = "update band_bandsman set status=2 where band_id=$band_id";        $q = "update band_bandsman set status=1 where band_id=$band_id and bandsman_id=$bandsman_id";        $this->db->query($q);    }    public function DenyBandMember($band_id, $bandsman_id) {        $q = "update band_bandsman set status=2 where band_id=$band_id and bandsman_id=$bandsman_id";        $this->db->query($q);    }    public function SelectTalentBandsman($sex, $instrument_id, $pagesize, $offset, $name = '') {        $q = "select bandsman.*,(select count(*) from collect where collect.entity_id=bandsman.id and entity_type=10) as count,instrument.name as instrument_name from bandsman left join instrument on bandsman.instrument_id=instrument.id where (1=1)";        if ($sex != 0) {            $q .= " and sex=$sex";        }        if ($name != '') {            $q .= " and bandsman.name like '%" . $name . "%'";        }        if ($instrument_id != 0) {            $q .= " and instrument_id=$instrument_id";        }        $q .= " and bandsman.instrument_id<>0";        $q .= " order by count desc limit $offset,$pagesize";        $query = $this->db->query($q);        return $query->result_array();    }    public function SelectTalentBand($music_style, $pagesize, $offset) {        $q = "select band.*,(select count(*) from collect where collect.entity_id=band.id and entity_type=11) as count from band";        if ($music_style != 0) {            $q .= " and music_style=$music_style";        }        $q .= " order by count desc limit $offset,$pagesize";        $query = $this->db->query($q);        return $query->result_array();    }    public function AgreeCampanionship($companionship_id, $bandsman_id) {        $this->db->query("update companionship_bandsman set status=2 where companionship_id=$companionship_id");        $this->db->query("update companionship_bandsman set status=1 where companionship_id=$companionship_id and bandsman_id=$bandsman_id");    }    public function SelectCompanionship($area, $instrument_id, $pagesize, $offset) {        $q = " select * from companionship where (1=1)";        if ($area != "") {            $q .= " and area like '%$area%'";        }        if ($instrument_id != "") {            $q .= " and `name` like '%$instrument_id%'";        }        $q .= " order by add_time desc limit $offset,$pagesize";        $query = $this->db->query($q);        return $query->result_array();    }    public function SelectBand($pagesize, $offset, $name = '', $need = "") {        $q = "select * from band where (1=1)";        if ($name != '') {            $q .= ' and name like "%' . $name . '%"';        }        if ($need != "") {            $q .= " and need like '%$need%'";        }        $q .= " order by add_time desc limit $offset,$pagesize";        $query = $this->db->query($q);        return $query->result_array();    }    public function GetCollectBandAndBandsman($user_id) {        $q = "select * from collect where user_id=$user_id and (entity_type=10 or entity_type=11)";        $query = $this->db->query($q);        return $query->result_array();    }}?>